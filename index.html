<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>A Smarter Weather</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script>
        async function fetchQuestion() {
            const response = await fetch('questions.json');
            const questions = await response.json();
            const today = new Date().toISOString().split('T')[0];
            const question = questions.find(q => q.date === today);

            if (question) {
                document.getElementById('equation').innerText = question.Equation;
                document.getElementById('correct_answer').value = question.Answer;
            } else {
                document.getElementById('equation').innerText = 'No question for today!';
            }
        }

        function showPopup(attempts) {
            const popup = document.getElementById('popup');
            popup.style.display = 'block';
            popup.innerHTML = `
                <p>Correct! You got it in ${attempts} attempts.</p>
                <button id="shareButton">Share</button>
                <div id="fallback" style="display:none;">
                    <p>Share this:</p>
                    <a href="#" id="facebookShare">Facebook</a>
                    <a href="#" id="twitterShare">Twitter</a>
                </div>
            `;

            document.getElementById('shareButton').addEventListener('click', () => share(attempts));
        }

        function share(attempts) {
            const shareData = {
                title: 'A Smarter Weather',
                text: `I solved today's math problem in ${attempts} attempts! Check it out:`,
                url: 'https://asmarterweather.github.io'
            };

            if (navigator.share) {
                navigator.share(shareData)
                    .then(() => console.log('Successful share'))
                    .catch((error) => {
                        console.log('Error sharing', error);
                        showFallback(shareData);
                    });
            } else {
                console.log('Web Share API not supported in this browser.');
                showFallback(shareData);
            }
        }

        function showFallback(shareData) {
            const fallback = document.getElementById('fallback');
            fallback.style.display = 'block';

            document.getElementById('facebookShare').href = `https://www.facebook.com/sharer/sharer.php?u=${shareData.url}`;
            document.getElementById('twitterShare').href = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareData.text)}%20${encodeURIComponent(shareData.url)}`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            fetchQuestion();

            const form = document.getElementById('answer-form');
            const correctAnswerInput = document.getElementById('correct_answer');
            const resultContainer = document.getElementById('result');
            let attempts = 0;

            form.addEventListener('submit', function(event) {
                event.preventDefault();
                const userAnswer = document.getElementById('answer').value.trim();
                const correctAnswer = correctAnswerInput.value.trim();
                attempts++;

                if (userAnswer === correctAnswer) {
                    showPopup(attempts);
                } else {
                    resultContainer.textContent = "Incorrect. Try again!";
                }
            });
        });
    </script>
</head>
<body>
    <h1>A Smarter Weather Forecast</h1>
    <div class="container">
        <div class="weather-input">
            <h3>Enter a City Name</h3>
            <input class="city-input" type="text" placeholder="E.g., New York, London, Tokyo">
            <button class="search-btn">Search</button>
            <div class="separator"></div>
            <button class="location-btn">Use Current Location</button>
        </div>
        <div class="weather-data">
            <div class="current-weather">
                <div class="details">
                    <h2>_______ ( ______ )</h2>
                    <h6>Temperature: __°C</h6>
                    <h6>Wind: __ M/S</h6>
                    <h6>Humidity: __%</h6>
                </div>
            </div>
            <div class="days-forecast">
                <h2>5-Day Forecast</h2>
                <ul class="weather-cards">
                    <li class="card">
                        <h3>( ______ )</h3>
                        <h6>Temp: __°C</h6>
                        <h6>Wind: __ M/S</h6>
                        <h6>Humidity: __%</h6>
                    </li>
                    <li class="card">
                        <h3>( ______ )</h3>
                        <h6>Temp: __°C</h6>
                        <h6>Wind: __ M/S</h6>
                        <h6>Humidity: __%</h6>
                    </li>
                    <li class="card">
                        <h3>( ______ )</h3>
                        <h6>Temp: __°C</h6>
                        <h6>Wind: __ M/S</h6>
                        <h6>Humidity: __%</h6>
                    </li>
                    <li class="card">
                        <h3>( ______ )</h3>
                        <h6>Temp: __°C</h6
